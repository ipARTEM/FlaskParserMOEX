{% extends "base.html" %}
{% from "heatmap.html" import render_grid %}


{% block content %}
<div class="toolbar">
  <a class="btn" href="{{ url_for('market.parser_page', mode='fast') }}">Обновить (fast)</a>
  <a class="btn" href="{{ url_for('market.parser_page', mode='fresh', admin_token=request.args.get('admin_token','')) }}">Обновить (fresh)</a>
</div>

<h2>Акции (TQBR)</h2>
{{ render_grid(stock_tiles) }}
<div class="grid">
  {% for t in stock_tiles %}
    <div class="tile" title="{{ t.secid }}: {{ t.last }}">
      <div class="tile-head">{{ t.secid }}</div>
      <div class="tile-name">{{ t.name }}</div>
      <div class="tile-num">{{ "%.2f"|format(t.change) if t.change is not none else "—" }}%</div>
    </div>
  {% endfor %}
</div>

<h2>Фьючерсы (RFUD)</h2>
{{ render_grid(fut_tiles) }}
<div class="grid">
  {% for t in fut_tiles %}
    <div class="tile" title="{{ t.secid }}: {{ t.last }}">
      <div class="tile-head">{{ t.secid }}</div>
      <div class="tile-name">{{ t.name }}</div>
      <div class="tile-num">{{ "%.2f"|format(t.change) if t.change is not none else "—" }}%</div>
    </div>
  {% endfor %}
</div>
{% endblock %}
